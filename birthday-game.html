<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday Zainul - Bee Catch with Fireworks</title>
  <style>
    body, html {
      margin:0; padding:0; height:100%;
      background: radial-gradient(ellipse at center, #0a122a 0%, #04081b 100%);
      font-family: Arial, sans-serif;
      color: white;
      user-select:none;
      overflow:hidden;
      position: relative;
    }
    #game-container {
      width: 480px;
      height: 640px;
      margin: 20px auto;
      position: relative;
      border-radius: 12px;
      box-shadow: 0 0 30px #ffcc66;
      background: #0a122a;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      background: transparent;
      position: absolute;
      top: 0; left: 0;
    }
    #stars {
      z-index: 0;
    }
    #game {
      z-index: 1;
    }
    #hud {
      position: relative;
      z-index: 2;
      text-align: center;
      font-size: 20px;
      margin-bottom: 5px;
      letter-spacing: 3px;
      color: #ffcc66;
      font-weight: 700;
      user-select:none;
    }
    #overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 200;
      user-select:none;
    }
    #dialog {
      background: #1a2136;
      padding: 2em 3em;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 0 20px #ffcc66;
    }
    #dialog p {
      font-size: 1.5em;
      margin-bottom: 1.5em;
    }
    #dialog button {
      font-size: 1.2em;
      padding: 0.6em 2em;
      border-radius: 9999px;
      border: none;
      background: #ff7b9a;
      color: white;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 6px 12px rgba(255, 123, 154, 0.5);
      transition: background 0.25s ease;
    }
    #dialog button:hover {
      background: #ff4f7a;
    }
    #final-message {
      margin-top: 1em;
      font-size: 1.8em;
      color: #ffdd88;
      font-weight: bold;
      text-shadow:
        0 0 10px #ffb600,
        0 0 20px #ffb600,
        0 0 30px #ffb600;
    }
    #birthday-text {
      font-size: 2.6em;
      font-weight: 900;
      color: #ffdd88;
      text-align: center;
      text-shadow:
        0 0 10px #ffb600,
        0 0 20px #ffb600,
        0 0 30px #ffb600,
        0 0 40px #ffb600,
        0 0 50px #ffb600,
        0 0 60px #ffb600;
      margin-bottom: 1.2em;
      user-select:none;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <div id="hud">Next Letter: <span id="next-letter"></span></div>
    <canvas id="stars" width="480" height="640"></canvas>
    <canvas id="game" width="480" height="640"></canvas>
    <canvas id="fireworks" width="480" height="640" style="pointer-events:none; position:absolute; top:0; left:0; z-index:150;"></canvas>
  </div>

  <div id="overlay" role="dialog" aria-modal="true" aria-labelledby="dialog-text">
    <div id="dialog" style="display:none;">
      <p id="dialog-text">Do you love Foumi?</p>
      <button id="yes-button">YES</button>
      <div id="final-message" hidden>Foumi loves you most &lt;3</div>
    </div>
    <div id="birthday-text" style="display:none;">HAPPY BIRTHDAYY ZAINUL</div>
  </div>

<script>
(() => {
  // Constants & Elements
  const MESSAGE = "HAPPY BIRTHDAY ZAINUL";
  const LETTERS = MESSAGE.split('');
  const starsCanvas = document.getElementById('stars');
  const starsCtx = starsCanvas.getContext('2d');
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const fwCanvas = document.getElementById('fireworks');
  const fwCtx = fwCanvas.getContext('2d');

  const nextLetterEl = document.getElementById('next-letter');
  const overlay = document.getElementById('overlay');
  const dialog = document.getElementById('dialog');
  const dialogText = document.getElementById('dialog-text');
  const yesButton = document.getElementById('yes-button');
  const finalMessage = document.getElementById('final-message');
  const birthdayText = document.getElementById('birthday-text');

  const W = canvas.width;
  const H = canvas.height;

  // Stars for background
  const stars = [];
  const NUM_STARS = 80;
  for(let i=0; i<NUM_STARS; i++){
    stars.push({
      x: Math.random()*W,
      y: Math.random()*H,
      radius: Math.random()*1.2 + 0.4,
      twinkle: Math.random()*100,
    });
  }
  function drawStars(time){
    starsCtx.clearRect(0, 0, W, H);
    stars.forEach(s => {
      const twinkleVal = 0.5 + 0.5*Math.sin((time + s.twinkle)*0.02);
      starsCtx.beginPath();
      starsCtx.arc(s.x, s.y, s.radius*twinkleVal, 0, 2*Math.PI);
      starsCtx.fillStyle = `rgba(255,255,255,${twinkleVal})`;
      starsCtx.fill();
    });
  }

  // Basket
  let basket = {
    x: W/2 - 60,
    y: H - 60,
    width: 120,
    height: 28,
    speed: 12,
  };

  // Bee size
  const beeRadius = 28;

  // Bee falling speed
  const beeSpeed = 5;

  // Current bee (letter carrier)
  let bee = null;

  // Next letter index
  let nextIndex = 0;

  // Controls
  let keys = {};
  window.addEventListener('keydown', e => { keys[e.key] = true; });
  window.addEventListener('keyup', e => { keys[e.key] = false; });

  // Drag support for basket
  let dragging = false;
  let dragOffsetX = 0;
  canvas.addEventListener('mousedown', e => {
    const rect = canvas.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;
    if(my > basket.y - 40 && mx > basket.x && mx < basket.x + basket.width){
      dragging = true;
      dragOffsetX = mx - basket.x;
      canvas.style.cursor = 'grabbing';
    }
  });
  window.addEventListener('mousemove', e => {
    if(dragging){
      const rect = canvas.getBoundingClientRect();
      const mx = e.clientX - rect.left;
      basket.x = mx - dragOffsetX;
      if(basket.x < 0) basket.x = 0;
      if(basket.x > W - basket.width) basket.x = W - basket.width;
    }
  });
  window.addEventListener('mouseup', e => {
    dragging = false;
    canvas.style.cursor = '';
  });
  canvas.addEventListener('touchstart', e => {
    const rect = canvas.getBoundingClientRect();
    const t = e.touches[0];
    const mx = t.clientX - rect.left;
    const my = t.clientY - rect.top;
    if(my > basket.y - 40 && mx > basket.x && mx < basket.x + basket.width){
      dragging = true;
      dragOffsetX = mx - basket.x;
    }
  }, {passive:false});
  window.addEventListener('touchmove', e => {
    if(dragging){
      e.preventDefault();
      const rect = canvas.getBoundingClientRect();
      const t = e.touches[0];
      const mx = t.clientX - rect.left;
      basket.x = mx - dragOffsetX;
      if(basket.x < 0) basket.x = 0;
      if(basket.x > W - basket.width) basket.x = W - basket.width;
    }
  }, {passive:false});
  window.addEventListener('touchend', e => {
    dragging = false;
  });

  // Spawn bee with letter
  function spawnBee(){
    if(nextIndex >= LETTERS.length) return;
    const letter = LETTERS[nextIndex];
    const x = Math.random()*(W - beeRadius*2) + beeRadius;
    bee = {
      x: x,
      y: -beeRadius*2,
      letter: letter,
      radius: beeRadius,
    };
    nextLetterEl.textContent = letter;
  }

  // Draw bee cartoon with letter (simple shape)
  function drawBee(b){
    const x = b.x;
    const y = b.y;
    const r = b.radius;

    // Body yellow circle
    ctx.beginPath();
    ctx.arc(x, y, r*0.7, 0, Math.PI*2);
    ctx.fillStyle = '#FFD500';
    ctx.fill();
    ctx.lineWidth = 3;
    ctx.strokeStyle = '#333';
    ctx.stroke();

    // Black stripes - simple lines
    ctx.lineWidth = 6;
    ctx.strokeStyle = '#222';
    for(let i=-0.4; i<=0.4; i+=0.4){
      ctx.beginPath();
      ctx.moveTo(x + i*r*0.5, y - r*0.6);
      ctx.lineTo(x + i*r*0.5, y + r*0.6);
      ctx.stroke();
    }

    // Wings (simple white ellipses)
    ctx.fillStyle = 'rgba(255,255,255,0.7)';
    ctx.beginPath();
    ctx.ellipse(x - r*0.4, y - r*0.6, r*0.3, r*0.5, Math.PI/6, 0, Math.PI*2);
    ctx.ellipse(x + r*0.4, y - r*0.6, r*0.3, r*0.5, -Math.PI/6, 0, Math.PI*2);
    ctx.fill();
    ctx.strokeStyle = '#555';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.ellipse(x - r*0.4, y - r*0.6, r*0.3, r*0.5, Math.PI/6, 0, Math.PI*2);
    ctx.stroke();
    ctx.beginPath();
    ctx.ellipse(x + r*0.4, y - r*0.6, r*0.3, r*0.5, -Math.PI/6, 0, Math.PI*2);
    ctx.stroke();

    // Eyes (black)
    ctx.fillStyle = '#111';
    ctx.beginPath();
    ctx.arc(x - r*0.25, y - r*0.15, r*0.15, 0, Math.PI*2);
    ctx.arc(x + r*0.25, y - r*0.15, r*0.15, 0, Math.PI*2);
    ctx.fill();

    // Pupils (white)
    ctx.fillStyle = '#fff';
    ctx.beginPath();
    ctx.arc(x - r*0.25, y - r*0.15, r*0.07, 0, Math.PI*2);
    ctx.arc(x + r*0.25, y - r*0.15, r*0.07, 0, Math.PI*2);
    ctx.fill();

    // Letter on bee - white bold with dark shadow for visibility
    ctx.font = 'bold 30px sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.shadowColor = 'rgba(0,0,0,0.7)';
    ctx.shadowOffsetX = 2;
    ctx.shadowOffsetY = 2;
    ctx.shadowBlur = 3;
    ctx.fillStyle = 'white';
    ctx.fillText(b.letter, x, y + 6);
    ctx.shadowColor = 'transparent'; // reset shadow
  }

  // Draw basket
  function drawBasket(){
    ctx.fillStyle = '#8b5e3c';
    ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
    ctx.fillStyle = '#a36b45';
    ctx.fillRect(basket.x, basket.y - 6, basket.width, 8);

    ctx.fillStyle = '#ffdfc1';
    ctx.fillRect(basket.x + 8, basket.y + 4, basket.width - 16, 6);

    ctx.beginPath();
    ctx.ellipse(basket.x + basket.width/2, basket.y + basket.height + 8, basket.width/2, 8, 0, 0, 2*Math.PI);
    ctx.fillStyle = 'rgba(0,0,0,0.25)';
    ctx.fill();
  }

  // Check catch
  function checkCatch(){
    if(!bee) return false;
    const closestX = Math.max(basket.x, Math.min(bee.x, basket.x + basket.width));
    const closestY = Math.max(basket.y, Math.min(bee.y, basket.y + basket.height));
    const dx = bee.x - closestX;
    const dy = bee.y - closestY;
    const distance = Math.sqrt(dx*dx + dy*dy);
    return distance < bee.radius + 4;
  }

  // Fireworks logic

  // Firework particle class
  class Particle {
    constructor(x,y,color){
      this.x = x;
      this.y = y;
      this.color = color;
      this.radius = 3;
      this.speed = Math.random()*4 + 2;
      this.angle = Math.random()*Math.PI*2;
      this.vx = Math.cos(this.angle)*this.speed;
      this.vy = Math.sin(this.angle)*this.speed;
      this.alpha = 1;
      this.decay = 0.015 + Math.random()*0.015;
      this.gravity = 0.05;
    }
    update(){
      this.vy += this.gravity;
      this.x += this.vx;
      this.y += this.vy;
      this.alpha -= this.decay;
      if(this.alpha < 0) this.alpha = 0;
      this.radius *= 0.96;
    }
    draw(ctx){
      ctx.save();
      ctx.globalAlpha = this.alpha;
      ctx.beginPath();
      ctx.fillStyle = this.color;
      ctx.shadowColor = this.color;
      ctx.shadowBlur = 8;
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
      ctx.fill();
      ctx.restore();
    }
    isDead(){
      return this.alpha <= 0 || this.radius <= 0.5;
    }
  }

  let fireworks = [];
  let fireworksTimeout = null;
  let fireworksCount = 0;
  const MAX_FIREWORKS = 7;

  function launchFirework(){
    if(fireworksCount >= MAX_FIREWORKS) return;
    fireworksCount++;
    const x = Math.random()*(W*0.8) + W*0.1;
    const y = Math.random()*H*0.3 + H*0.1;
    const colors = ['#ffcc66','#ff7b9a','#ffdd88','#a3e635','#67e8f9','#f472b6','#60a5fa'];
    const color = colors[Math.floor(Math.random()*colors.length)];
    for(let i=0; i<40; i++){
      fireworks.push(new Particle(x,y,color));
    }
    fireworksTimeout = setTimeout(launchFirework, 400);
  }

  function startFireworks(){
    fireworksCount = 0;
    launchFirework();
  }

  function updateFireworks(){
    fwCtx.clearRect(0,0,W,H);
    fireworks.forEach((p,i) => {
      p.update();
      p.draw(fwCtx);
      if(p.isDead()){
        fireworks.splice(i,1);
      }
    });
  }

  // Game variables
  let lastTime = 0;
  let running = true;
  let showFireworks = false;
  let fireworksStarted = false;
  let fireworksDuration = 4000;
  let fireworksStartTime = 0;

  // Show/hide overlay
  function showOverlay(){
    overlay.style.visibility = 'visible';
    overlay.style.opacity = '1';
  }
  function hideOverlay(){
    overlay.style.visibility = 'hidden';
    overlay.style.opacity = '0';
  }

  // Yes button event
  yesButton.onclick = () => {
    dialogText.textContent = '';
    yesButton.style.display = 'none';
    finalMessage.hidden = false;
  };

  // Game loop
  function gameLoop(timestamp){
    if(!lastTime) lastTime = timestamp;
    const dt = timestamp - lastTime;
    lastTime = timestamp;

    drawStars(timestamp);

    if(running){
      // Basket movement
      if(keys['ArrowLeft']) basket.x -= basket.speed;
      if(keys['ArrowRight']) basket.x += basket.speed;
      if(basket.x < 0) basket.x = 0;
      if(basket.x > W - basket.width) basket.x = W - basket.width;

      // Move bee down
      if(bee){
        bee.y += beeSpeed;

        if(checkCatch()){
          nextIndex++;
          if(nextIndex >= LETTERS.length){
            bee = null;
            running = false;
            showFireworks = true;
            fireworksStarted = false;
            fireworksStartTime = timestamp;

            birthdayText.style.display = 'block';
            nextLetterEl.textContent = '';

            setTimeout(() => {
              // Stop fireworks and show dialog
              showFireworks = false;
              birthdayText.style.display = 'none';
              dialog.style.display = 'block';
              dialogText.textContent = 'Do you love Foumi?';
              yesButton.style.display = 'inline-block';
              finalMessage.hidden = true;
              showOverlay();
            }, fireworksDuration + 1500);
          } else {
            spawnBee();
          }
        } else if(bee.y - bee.radius > H){
          spawnBee();
        }
      }

      ctx.clearRect(0,0,W,H);
      if(bee) drawBee(bee);
      drawBasket();

      nextLetterEl.textContent = LETTERS[nextIndex];

      if(showFireworks){
        if(!fireworksStarted){
          fireworksStarted = true;
          startFireworks();
        }
        updateFireworks();
      } else {
        fwCtx.clearRect(0,0,W,H);
      }
    }
    requestAnimationFrame(gameLoop);
  }

  // Initialize
  spawnBee();
  requestAnimationFrame(gameLoop);

})();
</script>
</body>
</html>
